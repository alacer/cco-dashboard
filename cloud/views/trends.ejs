<% include header.ejs %>

   <script>
$(function() {

    $.parse.init({app_id:"QlR7raDX8sggg5ebpDkgBXVANXhPPmpUKZRmOaMS",
                   rest_key: "urhXUisVSqEOMoHhYp4W624k3Putu4YZAeJ7E26p"});

/* ---------------------------------- */
/* Charts Variables                   */
/* ---------------------------------- */
  var
    volumeWeekSeriesOptions = [],
    volumeWeekSeriesCounter = 0,
    volumeWeekSeriesNames = ['Received', 'InQueue', 'Completed'],
    queueWeekSeriesOptions = [],
    queueWeekSeriesCounter = 0,
    queueWeekSeriesNames = ['OK', 'Caution', 'Warning'],    
    colors = App.chartColors,
    teamChartColors = ['#d9534f','#e69900','#9c3','#69c','#96c','#e4784e','#d96600','#3366b2'];

    var jsonArray = new Array();

    $.parse.get('metric',
      function(x) {
        for(var i = 0; i < x.results.length; i++) {
           jsonArray.push(x.results[i]);
  //         console.log(x.results[i]))
        }
      } 
    );

  console.log(jsonArray);

/* ---------------------------------- */
/* Volume Per Week Chart (Default)    */
/* ---------------------------------- */
//Load all of the Volume chart data
  $.each(volumeWeekSeriesNames, function(i, volumeWeekSeriesName) {

//    $.getJSON(Metrics, function(data) {
      var friendlyName, volumeData, yAxis;
      switch (volumeWeekSeriesName) {
        case ('Received'):
          friendlyName = 'Received';
          volumeData = Received;
          yAxis = 0;
          break;
        case ('InQueue'):
          friendlyName = 'In Queue';
          volumeData = data.volumeWeekDataInQueue;
          yAxis = 0;
          break;
        case ('Completed'):
          friendlyName = 'Completed';
          volumeData = data.volumeWeekDataCompleted;
          yAxis = 0;
          break;

      }
      volumeWeekSeriesOptions[i] = {
        name: friendlyName,
        data: volumeData,
        yAxis: yAxis
      };
      volumeWeekSeriesCounter++;
      if (volumeWeekSeriesCounter == volumeWeekSeriesNames.length) {
        createVolumeChart();
      }
    //});
  });
//Create the Volume chart when all data are loaded
  function createVolumeChart() {
    $('#AlertsPerformance_WeekViews_VolumeChart').highcharts('StockChart', {
      chart: {
        height: 250,
        marginLeft: 35,
        marginRight: 45
      },
      title:{
        text: 'testing'
      },
      credits: {
        enabled: false
      },
      navigator: {
        enabled: true
      },
      scrollbar: {
        enabled: false
      },
      rangeSelector: {
        enabled: false
      },
      colors: ['#e69900', '#9c3', '#69c', '#669', '#d9534f'],
      navigation: {
        buttonOptions: {
          enabled: true
        }
      },
      plotOptions: {
        series: {
          shadow: true
        }
      },
      xAxis: {
        type: 'datetime',
        dateTimeLabelFormats: {
          day: '%m/%d/%y'
        },
      },
      yAxis: [{
        min: 0,
        max: 30,
        labels: {
          formatter: function() {
            return (this.value);
          },
          align: 'right',
          x: -3,
          y: 3
        },
        gridLineColor: '#efefef',
        lineWidth: 1,
        lineColor: '#efefef',
        tickPositions: [0, 5, 10, 15, 20, 25, 30],
        minPadding: 0,
        maxPadding: 0.15,
        showFirstLabel: false,
        showLastLabel: false,
        startOnTick: false,
        endOnTick: false
      }],
      tooltip: {
        pointFormat: '<span style="color:{series.color};font-weight:bold;">{series.name}</span>: {point.y} Cases<br/>',
        valueDecimals: 0
      },
      series: volumeWeekSeriesOptions
    });
  }
});
</script>

        <!-- Content Header -->
        <div id="content-header">
          <h1>Trends</h1>
        </div>
        <!-- Primary Content Container -->
        <div id="content-container">

          <!-- Performance Charts Tabs Content -->
          <div id="AlertsPerformance_TabsContent" class="tab-content">
            <!-- Data View: Alert Volume Per Week -->
              <div class="row">
                <!-- Chart: Volume, Week View -->
                <div class="col-md-6 col-sm-12">              
                  <div id="AlertsPerformance_WeekViews_VolumeChart"></div>
                <!-- </div>
                <div class="row">
                <div class="col-md-6 col-sm-12"> -->
                  <div id="AlertsPerformance_WeekViews_QueueChart"></div>
                </div>

                <div class="col-md-6 col-sm-12">   
              <div class="table-responsive">
                <table class="table table-striped table-bordered table-hover table-highlight table-checkable" data-provide="datatable" data-display-rows="20" data-info="false" data-search="false" data-length-change="true" data-paginate="false">
                  <thead>
                    <tr>
                      <th data-filterable="true" data-sortable="true" data-direction="asc">Metric</th>
                      <th data-filterable="false" data-sortable="false">Received</th>
                      <th data-filterable="false" data-sortable="false">Completed</th>
                      <th data-filterable="false" data-sortable="false">In Queue</th>
                      <th data-filterable="false" data-sortable="false">Comments</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr data-alert-id="12345">
                      <td>KYC New Customer Onboarding QA Review</td>
                      <td><i class="fa fa-arrow-up"></i> 5</td>
                      <td><i class="fa fa-arrow-up"></i> 2</td>
                      <td>
                        <a href="" class="ui-popover" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-content="&lt 1 Day: 5 <br/> &gt 1 to &lt 5 Days: 2 <br/> &gt 5 Days: 3" title="In Queue Totals" data-html=TRUE>
                          <div class="progress">
                    
                            <div class="progress-bar progress-bar-success" style="width: 55%">
                            
                            </div>
                            <div class="progress-bar progress-bar-warning progress-bar-striped" style="width: 20%; background-color: #FFF000">
                            </div>
                            <div class="progress-bar progress-bar-danger" style="width: 25%">
                            </div>
                        </div>
                        </a>
                      </td>
                      <td><a href="" class="ui-popover" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-content="Team still working through June backlog." title="Explanation"><i class="fa fa-comments-o text-xl"></i></a></td>
                    </tr>
                    <tr data-alert-id="12346">
                      <td>KYC Periodic Reviews</td>
                      <td><i class="fa fa-arrow-down"></i> 1</td>
                      <td><i class="fa fa-arrow-down"></i> 5</td>
                      <td>
                        <div class="progress">
                          <div class="progress-bar progress-bar-success" style="width: 75%">
                          </div>
                          <div class="progress-bar progress-bar-warning progress-bar-striped" style="width: 20%; background-color: #FFF000">
                          </div>
                          <div class="progress-bar progress-bar-danger" style="width: 5%">
                          </div>
                        </div>
                      </td>
                      <td><a href="" class="ui-popover" data-toggle="tooltip" data-placement="left" data-trigger="hover" data-content="A few cases required additional investigation" title="Explanation"><i class="fa fa-comments-o text-xl"></i></a></td>
                    </tr>

    
                  </tbody>
                </table>
              </div>
              </div>


              </div>

            <!-- /Data View: 1st Time Right Determination/Accuracy Per Week -->
          </div>
          <!-- /Performance Charts Tabs Content -->
        </div>          

<% include footer.ejs %>